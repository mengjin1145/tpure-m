# Tpure 主题命名规范文档

> 版本: 5.0.6  
> 更新日期: 2025-10-12

## 1. PHP 函数命名规范

### 1.1 命名空间规范

```php
namespace Tpure\模块名;
```

主题使用命名空间组织代码：
- `Tpure\Security` - 安全相关函数
- `Tpure\Ajax` - AJAX处理函数
- `Tpure\Mail` - 邮件相关函数
- `Tpure\Helpers` - 辅助工具函数

### 1.2 全局函数命名

所有全局函数必须以 `tpure_` 为前缀，避免与其他插件/主题冲突。

**格式**: `tpure_动词_名词()` 或 `tpure_名词_动词()`

**示例**:
```php
// ✅ 正确
function tpure_validate_email($email)
function tpure_sanitize_text($text)
function tpure_get_hot_articles($count)
function tpure_create_module()

// ❌ 错误
function validateEmail($email)          // 缺少前缀
function tpureValidateEmail($email)     // 不应使用驼峰命名
function tpure_email($email)            // 不够明确
```

### 1.3 钩子函数命名

Z-BlogPHP 插件钩子函数遵循官方规范：

**格式**: `动作_Plugin_主题名` 或 `Filter_Plugin_钩子名称_主题名`

**示例**:
```php
// 激活钩子
function ActivePlugin_tpure()

// 安装钩子
function InstallPlugin_tpure()

// 卸载钩子
function UninstallPlugin_tpure()

// 更新钩子
function UpdatePlugin_tpure()

// 过滤器钩子
function Filter_Plugin_PostArticle_Core($article)
function Filter_Plugin_Cmd_Ajax($cmd)
```

### 1.4 类命名规范

使用 PascalCase（大驼峰命名法）：

```php
// ✅ 正确
class TpureErrorHandler
class TpureCache
class TpureConfig

// ❌ 错误
class tpure_error_handler
class tpureErrorhandler
class Tpure_Error_Handler
```

### 1.5 方法命名规范

- **公共方法**: 使用 camelCase（小驼峰命名法）
- **私有方法**: 使用 camelCase + 私有标识

```php
class TpureErrorHandler {
    // 公共方法
    public static function init()
    public static function handleError()
    public static function safeExecute()
    
    // 私有方法
    private static function getErrorType()
    private static function showFriendlyError()
}
```

## 2. 变量命名规范

### 2.1 局部变量

使用 camelCase：

```php
// ✅ 正确
$userName = 'test';
$postCount = 10;
$isValid = true;
$articleList = [];

// ❌ 错误
$user_name = 'test';    // 不推荐用下划线
$PostCount = 10;        // 不应大写开头
$is_valid = true;       // 不推荐用下划线
```

### 2.2 全局变量

Z-BlogPHP 核心全局变量保持原样：

```php
global $zbp;          // Z-BlogPHP 核心对象
global $article;      // 当前文章
global $category;     // 当前分类
```

主题自定义全局变量使用 `TPURE_` 前缀：

```php
$GLOBALS['TPURE_CACHE'] = [];
$GLOBALS['TPURE_CONFIG'] = [];
```

### 2.3 jQuery 变量

jQuery 对象变量使用 `$` 前缀：

```javascript
// ✅ 正确
const $searchInput = $('.schinput');
const $menu = $('.menu');

// ❌ 错误
const searchInput = $('.schinput');   // 不易识别为jQuery对象
```

## 3. 常量命名规范

### 3.1 常量名称

全部大写，使用下划线分隔：

```php
// ✅ 正确
define('TPURE_VERSION', '5.0.6');
define('TPURE_MAX_UPLOAD_SIZE', 5 * 1024 * 1024);
define('TPURE_DEFAULT_INTRO_LENGTH', 110);

// ❌ 错误
define('tpure_version', '5.0.6');
define('TpureMaxUploadSize', 5242880);
define('tpure_DefaultIntroLength', 110);
```

### 3.2 常量分组

使用统一前缀便于识别：

```php
// 版本信息
TPURE_VERSION
TPURE_VERSION_BUILD

// 安全相关
TPURE_MAX_UPLOAD_SIZE
TPURE_ALLOWED_IMAGE_TYPES

// 内容相关
TPURE_DEFAULT_INTRO_LENGTH
TPURE_MAX_SEARCH_RESULTS

// 路径相关
TPURE_THEME_PATH
TPURE_THEME_URL
```

## 4. JavaScript 函数命名规范

### 4.1 普通函数

使用 camelCase：

```javascript
// ✅ 正确
function initNavigation()
function initSearch()
function updateGravatar(email)

// ❌ 错误
function init_navigation()
function InitSearch()
function update_gravatar(email)
```

### 4.2 事件处理函数

使用 `handle` 或 `on` 前缀：

```javascript
// ✅ 正确
function handleSearchInput(e)
function onMenuClick(e)
function handleFormSubmit(e)

// ❌ 错误
function searchInput(e)
function menuClick(e)
```

### 4.3 配置对象

全局配置使用 camelCase：

```javascript
const tpureConfig = {
    ajaxsearch: true,
    lazyload: true,
    nightMode: false,
    version: '5.0.6'
};
```

## 5. CSS 类命名规范

### 5.1 BEM 命名法

推荐使用 BEM（Block Element Modifier）命名：

```css
/* Block */
.search-panel { }

/* Element */
.search-panel__input { }
.search-panel__button { }

/* Modifier */
.search-panel--active { }
.search-panel__button--disabled { }
```

### 5.2 主题专用类

使用 `tpure-` 前缀避免冲突：

```css
.tpure-header { }
.tpure-navbar { }
.tpure-footer { }
.tpure-sidebar { }
```

### 5.3 状态类

使用 `is-` 或 `has-` 前缀：

```css
.is-active { }
.is-hidden { }
.is-loading { }
.has-error { }
.has-dropdown { }
```

## 6. 文件命名规范

### 6.1 PHP 文件

- 全部小写
- 使用连字符分隔（kebab-case）

```
lib/
  ├── constants.php
  ├── error-handler.php
  ├── security.php
  ├── ajax.php
  ├── mail.php
  └── helpers.php
```

### 6.2 JavaScript 文件

```
script/
  ├── common.js          # 压缩后的生产版本
  └── src/
      └── main.js        # 源文件
```

### 6.3 CSS 文件

```
style/
  ├── style.css          # 编译后的CSS
  └── style.less         # LESS源文件
```

### 6.4 模板文件

```
template/
  ├── header.php
  ├── footer.php
  ├── single.php         # 单篇文章
  ├── post-single.php    # 文章模板
  └── comments.php       # 评论模板
```

## 7. 数据库字段命名

遵循 Z-BlogPHP 数据库规范，使用下划线分隔：

```php
// 文章字段
$article->log_Title
$article->log_Content
$article->log_PostTime

// 用户字段
$user->mem_Name
$user->mem_Email

// 主题自定义字段使用 Metas
$article->Metas->proimg        // 自定义缩略图
$article->Metas->description   // SEO描述
```

## 8. 钩子命名规范

### 8.1 注册钩子函数

```php
// 格式: Add_Filter_Plugin('钩子名称', '回调函数')
Add_Filter_Plugin('Filter_Plugin_Cmd_Ajax', 'Tpure\Ajax\tpure_CmdAjax');
Add_Filter_Plugin('Filter_Plugin_PostArticle_Core', 'Tpure\Mail\tpure_ArticleCore');
```

### 8.2 自定义钩子

如需创建自定义钩子：

```php
// 定义钩子点
$content = RunFilter('Filter_Plugin_Tpure_ContentOutput', $content);

// 其他插件可以挂载
Add_Filter_Plugin('Filter_Plugin_Tpure_ContentOutput', 'my_custom_filter');
```

## 9. 配置项命名

### 9.1 Z-BlogPHP 配置

使用 PascalCase（兼容旧版）：

```php
$zbp->Config('tpure')->PostMAILON
$zbp->Config('tpure')->PostLOGO
$zbp->Config('tpure')->PostTHUMBON
```

### 9.2 新增配置建议

新增配置项遵循模块化命名：

```php
// 格式: 模块_功能_属性
$zbp->Config('tpure')->Mail_SMTP_Host
$zbp->Config('tpure')->Mail_SMTP_Port
$zbp->Config('tpure')->Search_Ajax_Enabled
$zbp->Config('tpure')->Theme_Night_AutoStart
```

## 10. 命名检查清单

在编写代码时，请检查：

- [ ] 所有全局函数是否以 `tpure_` 开头？
- [ ] 所有常量是否全部大写并以 `TPURE_` 开头？
- [ ] 类名是否使用 PascalCase？
- [ ] 方法和变量是否使用 camelCase？
- [ ] 钩子函数是否遵循 Z-BlogPHP 官方规范？
- [ ] 命名是否足够清晰，见名知意？
- [ ] 是否避免了缩写（除非是公认的缩写如 URL、HTML）？

## 11. 不推荐的命名

### 11.1 避免单字母变量

```php
// ❌ 避免
for ($i = 0; $i < count($a); $i++) {
    $x = $a[$i];
}

// ✅ 推荐
foreach ($articles as $article) {
    // 处理文章
}
```

### 11.2 避免拼音命名

```php
// ❌ 避免
function tpure_huoqu_wenzhang()

// ✅ 推荐
function tpure_get_article()
```

### 11.3 避免过于简短

```php
// ❌ 避免
function tpure_gt()
function tpure_sv()

// ✅ 推荐
function tpure_get_title()
function tpure_save_config()
```

## 12. 命名参考资源

- [Z-BlogPHP 官方开发文档](https://docs.zblogcn.com/)
- [PSR-1 基础编码规范](https://www.php-fig.org/psr/psr-1/)
- [PSR-12 扩展编码规范](https://www.php-fig.org/psr/psr-12/)
- [BEM 命名规范](http://getbem.com/)

---

**注意**: 本规范适用于 Tpure v5.0.6 及以后版本。旧版本代码在重构时应逐步迁移至新规范。

